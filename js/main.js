'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}(function(){'use strict';function a(a){if(i=a,j.setNumber(i),i.length===m.limit){var b=m.candies.filter(function(a){return a.number===i})[0];b?j.set(b):j.setNull()}}function b(){n=!1,a(''),j.clear()}function c(a){return(m=l[a],!!m)&&(m.index=a,j.setPosition(m.position),b(),m)}function d(){k=[],c(0)}function e(a,b,c){b.collection(a).get().then(function(a){a.forEach(function(a){var b=a.data();b.ref=a.ref,b.id=a.id,c(b,a.ref)})})}function f(a){console.log('Enviando votos');var b=a.map(function(a){var b=a.position,c=a.candies,d=a.vote,e=d?c.filter(function(a){return a.number===d})[0]||g.nullCandy():g.blankCandy(),f=e.name,h=e.party;return{position:b,vote:d,name:f,party:h}});console.table(b)}var g=function(){function a(b,c,d,e){_classCallCheck(this,a),this.img=e,this.name=c,this.party=d,this.number=b}return _createClass(a,[{key:'plainObject',value:function plainObject(){return{img:this.img,name:this.name,party:this.party,number:this.number}}}],[{key:'nullCandy',value:function nullCandy(){return new a('','N\xDAMERO ERRADO','VOTO NULO')}},{key:'blankCandy',value:function blankCandy(){return new a('','','VOTO EM BRANCO')}}]),a}(),h=function(){function a(b){_classCallCheck(this,a);var c=this.root=document.querySelector(b);c&&(this.position=c.querySelector('.display-position'),this.number=c.querySelector('.display-number'),this.img=c.querySelector('.display-img'),this.blank_img=this.img.src,this.name=c.querySelector('.display-name'),this.party=c.querySelector('.display-party'),this.body=c.querySelector('.display-body'),this.footer=c.querySelector('.display-footer'))}return _createClass(a,[{key:'setNumber',value:function(a){this.number.textContent=a.trim()}},{key:'setPosition',value:function setPosition(a){this.position.textContent=a.trim()}},{key:'set',value:function set(a){this.img.src=a.img||this.blank_img,this.name.textContent=a.name,this.party.textContent=a.party,this.body.removeAttribute('hidden'),this.footer.removeAttribute('hidden')}},{key:'setNull',value:function setNull(){this.set(g.nullCandy()),this.root.classList.add('is-null')}},{key:'setBlank',value:function setBlank(){this.set(g.blankCandy()),this.root.classList.add('is-blank')}},{key:'clear',value:function(){this.img.src=this.blank_img,this.name.textContent='',this.party.textContent='',this.body.setAttribute('hidden',!0),this.footer.setAttribute('hidden',!0),this.root.classList.remove('is-null'),this.root.classList.remove('is-blank')}}]),a}(),j=new h('.display'),i='',k=[],l=[],m={},n=!1,o={insert:function insert(b){return!n&&!(isNaN(b)||0>b)&&!(i.length>=m.limit)&&void a(i+b)},confirm:function confirm(){if((i.length===m.limit||n)&&(m.vote=i||null,k.push(m),!c(m.index+1))){var a=k;return c(0),d(),a}},blank:function blank(){n=!0,i||j.setBlank()},start:function start(a){l=a,c(0)},clear:b,votes:k,display:j},p=window.firebase.auth(),q=window.firebase.firestore(),r=[];e('ballots',q,function(a,b){r.push(a),a.steps=[],e('steps',b,function(b,c){b.ref=c,a.steps.push(b),b.candies=[],e('candies',c,function(a){b.candies.push(a),new Image().src=a.img}),o.start(r[0].steps)})});var s={digitar:function digitar(){o.insert(this.textContent.trim())},branco:function branco(){o.blank()},corrigir:function corrigir(){o.clear()},confirmar:function confirmar(){var a=o.confirm();a&&f(a)}};Array.prototype.forEach.call(document.querySelectorAll('.panel button'),function(a){return a.addEventListener('click',function(){s[this.dataset.click].call(this)})})})();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsic2V0TnVtYmVyIiwibGVuZ3RoIiwibGltaXQiLCJjYW5kaWVzIiwiZmlsdGVyIiwibnVtYmVyIiwic2V0Iiwic2V0TnVsbCIsImNsZWFyIiwiaW5kZXgiLCJzZXRQb3NpdGlvbiIsInBvc2l0aW9uIiwiY29sbGVjdGlvbiIsImdldCIsInRoZW4iLCJmb3JFYWNoIiwiZGF0YSIsInJlZiIsImlkIiwiY29uc29sZSIsImxvZyIsIm1hcCIsInZvdGUiLCJudWxsQ2FuZHkiLCJibGFua0NhbmR5IiwibmFtZSIsInBhcnR5IiwidGFibGUiLCJpbWciLCJyb290IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYmxhbmtfaW1nIiwic3JjIiwiYm9keSIsImZvb3RlciIsInRleHRDb250ZW50IiwidHJpbSIsInJlbW92ZUF0dHJpYnV0ZSIsImNsYXNzTGlzdCIsImFkZCIsInNldEF0dHJpYnV0ZSIsInJlbW92ZSIsImluc2VydCIsImlzTmFOIiwiY29uZmlybSIsInB1c2giLCJibGFuayIsInNldEJsYW5rIiwic3RhcnQiLCJ2b3RlcyIsImRpc3BsYXkiLCJ3aW5kb3ciLCJmaXJlYmFzZSIsImF1dGgiLCJmaXJlc3RvcmUiLCJzdGVwcyIsIkltYWdlIiwiZGlnaXRhciIsImJyYW5jbyIsImNvcnJpZ2lyIiwiY29uZmlybWFyIiwiQXJyYXkiLCJwcm90b3R5cGUiLCJjYWxsIiwicXVlcnlTZWxlY3RvckFsbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJkYXRhc2V0IiwiY2xpY2siXSwibWFwcGluZ3MiOiJ5WEFBQyxXQUFZLENBQ2IsYUFzSEEsYUFBd0IsQ0FHcEIsR0FGQSxHQUVBLENBREEsRUFBUUEsU0FBUixHQUNBLENBQUksRUFBT0MsTUFBUCxHQUFrQixFQUFLQyxLQUEzQixDQUFrQyxDQUM5QixHQUFNLEdBQVEsRUFBS0MsT0FBTCxDQUFhQyxNQUFiLENBQW9CLGtCQUFLLEdBQUVDLE1BQUYsSUFBTCxDQUFwQixFQUE4QyxDQUE5QyxDQUFkLENBRDhCLEVBRW5CLEVBQVFDLEdBQVIsR0FGbUIsQ0FHekIsRUFBUUMsT0FBUixFQUNSLENBQ0osQ0FFRCxZQUFpQixDQUNiLElBRGEsQ0FFYixFQUFVLEVBQVYsQ0FGYSxDQUdiLEVBQVFDLEtBQVIsRUFDSCxDQUVELGFBQW9CLFFBQ2hCLEVBQU8sSUFEUyxFQUVaLEVBRlksSUFHaEIsRUFBS0MsS0FBTCxFQUhnQixDQUloQixFQUFRQyxXQUFSLENBQW9CLEVBQUtDLFFBQXpCLENBSmdCLENBS2hCLEdBTGdCLEdBT25CLENBRUQsWUFBbUIsQ0FDZixFQUFRLEVBRE8sQ0FFZixFQUFRLENBQVIsQ0FDSCxDQU9ELGlCQUErQyxDQUMzQyxFQUFJQyxVQUFKLElBQXlCQyxHQUF6QixHQUErQkMsSUFBL0IsQ0FBb0MsV0FBUSxDQUN4QyxFQUFLQyxPQUFMLENBQWEsV0FBUSxDQUNqQixHQUFNLEdBQU8sRUFBS0MsSUFBTCxFQUFiLENBQ0EsRUFBS0MsR0FBTCxDQUFXLEVBQUtBLEdBRkMsQ0FHakIsRUFBS0MsRUFBTCxDQUFVLEVBQUtBLEVBSEUsQ0FJakIsSUFBZSxFQUFLRCxHQUFwQixDQUNILENBTEQsQ0FNSCxDQVBELENBUUgsQ0FvREQsYUFBMkIsQ0FDdkJFLFFBQVFDLEdBQVIsQ0FBWSxnQkFBWixDQUR1QixDQUd2QixHQUFNLEdBQVUsRUFBTUMsR0FBTixDQUFVLFdBQUssU0FFdkJWLFFBRnVCLEtBR3ZCUixPQUh1QixLQUl2Qm1CLElBSnVCLENBTXJCLEVBQVEsRUFFVixFQUFRbEIsTUFBUixDQUFlLGtCQUFLLEdBQUVDLE1BQUYsSUFBTCxDQUFmLEVBQXVDLENBQXZDLEdBQ0EsRUFBTWtCLFNBQU4sRUFIVSxDQUNWLEVBQU1DLFVBQU4sRUFQdUIsS0FXdkJDLElBWHVCLEtBWXZCQyxLQVp1QixDQWMzQixNQUFPLENBQ0hmLFVBREcsQ0FFSFcsTUFGRyxDQUdIRyxNQUhHLENBSUhDLE9BSkcsQ0FNVixDQXBCZSxDQUFoQixDQXNCQVAsUUFBUVEsS0FBUixHQUNILENBalBZLGlCQUlULG1CQUFzQyx5QkFDbEMsS0FBS0MsR0FBTCxFQURrQyxDQUVsQyxLQUFLSCxJQUFMLEVBRmtDLENBR2xDLEtBQUtDLEtBQUwsRUFIa0MsQ0FJbEMsS0FBS3JCLE1BQUwsRUFDSCxDQVRRLHNFQVVLLENBQ1YsTUFBTyxDQUNIdUIsSUFBSyxLQUFLQSxHQURQLENBRUhILEtBQU0sS0FBS0EsSUFGUixDQUdIQyxNQUFPLEtBQUtBLEtBSFQsQ0FJSHJCLE9BQVEsS0FBS0EsTUFKVixDQU1WLENBakJRLCtDQWtCVSxDQUNmLE1BQU8sT0FBVSxFQUFWLENBQWMsa0JBQWQsQ0FBK0IsV0FBL0IsQ0FDVixDQXBCUSwrQ0FxQlcsQ0FDaEIsTUFBTyxPQUFVLEVBQVYsQ0FBYyxFQUFkLENBQWtCLGdCQUFsQixDQUNWLENBdkJRLHNCQTRCVCxhQUFrQix5QkFDZCxHQUFNLEdBQU8sS0FBS3dCLElBQUwsQ0FBWUMsU0FBU0MsYUFBVCxHQUF6QixDQURjLElBR2QsS0FBS3BCLFFBQUwsQ0FBZ0IsRUFBS29CLGFBQUwsQ0FBbUIsbUJBQW5CLENBSEYsQ0FJZCxLQUFLMUIsTUFBTCxDQUFjLEVBQUswQixhQUFMLENBQW1CLGlCQUFuQixDQUpBLENBS2QsS0FBS0gsR0FBTCxDQUFXLEVBQUtHLGFBQUwsQ0FBbUIsY0FBbkIsQ0FMRyxDQU1kLEtBQUtDLFNBQUwsQ0FBaUIsS0FBS0osR0FBTCxDQUFTSyxHQU5aLENBT2QsS0FBS1IsSUFBTCxDQUFZLEVBQUtNLGFBQUwsQ0FBbUIsZUFBbkIsQ0FQRSxDQVFkLEtBQUtMLEtBQUwsQ0FBYSxFQUFLSyxhQUFMLENBQW1CLGdCQUFuQixDQVJDLENBU2QsS0FBS0csSUFBTCxDQUFZLEVBQUtILGFBQUwsQ0FBbUIsZUFBbkIsQ0FURSxDQVVkLEtBQUtJLE1BQUwsQ0FBYyxFQUFLSixhQUFMLENBQW1CLGlCQUFuQixDQVZBLENBV2pCLENBdkNRLHlEQXlDSSxDQUNULEtBQUsxQixNQUFMLENBQVkrQixXQUFaLENBQTBCLEVBQUVDLElBQUYsRUFDN0IsQ0EzQ1Esa0RBNkNNLENBQ1gsS0FBSzFCLFFBQUwsQ0FBY3lCLFdBQWQsQ0FBNEIsRUFBRUMsSUFBRixFQUMvQixDQS9DUSxrQ0FpREUsQ0FDUCxLQUFLVCxHQUFMLENBQVNLLEdBQVQsQ0FBZSxFQUFNTCxHQUFOLEVBQWEsS0FBS0ksU0FEMUIsQ0FFUCxLQUFLUCxJQUFMLENBQVVXLFdBQVYsQ0FBd0IsRUFBTVgsSUFGdkIsQ0FHUCxLQUFLQyxLQUFMLENBQVdVLFdBQVgsQ0FBeUIsRUFBTVYsS0FIeEIsQ0FJUCxLQUFLUSxJQUFMLENBQVVJLGVBQVYsQ0FBMEIsUUFBMUIsQ0FKTyxDQUtQLEtBQUtILE1BQUwsQ0FBWUcsZUFBWixDQUE0QixRQUE1QixDQUNILENBdkRRLHlDQXlEQyxDQUNOLEtBQUtoQyxHQUFMLENBQVMsRUFBTWlCLFNBQU4sRUFBVCxDQURNLENBRU4sS0FBS00sSUFBTCxDQUFVVSxTQUFWLENBQW9CQyxHQUFwQixDQUF3QixTQUF4QixDQUNILENBNURRLDJDQThERSxDQUNQLEtBQUtsQyxHQUFMLENBQVMsRUFBTWtCLFVBQU4sRUFBVCxDQURPLENBRVAsS0FBS0ssSUFBTCxDQUFVVSxTQUFWLENBQW9CQyxHQUFwQixDQUF3QixVQUF4QixDQUNILENBakVRLCtCQW1FRCxDQUNKLEtBQUtaLEdBQUwsQ0FBU0ssR0FBVCxDQUFlLEtBQUtELFNBRGhCLENBRUosS0FBS1AsSUFBTCxDQUFVVyxXQUFWLENBQXdCLEVBRnBCLENBR0osS0FBS1YsS0FBTCxDQUFXVSxXQUFYLENBQXlCLEVBSHJCLENBSUosS0FBS0YsSUFBTCxDQUFVTyxZQUFWLENBQXVCLFFBQXZCLElBSkksQ0FLSixLQUFLTixNQUFMLENBQVlNLFlBQVosQ0FBeUIsUUFBekIsSUFMSSxDQU1KLEtBQUtaLElBQUwsQ0FBVVUsU0FBVixDQUFvQkcsTUFBcEIsQ0FBMkIsU0FBM0IsQ0FOSSxDQU9KLEtBQUtiLElBQUwsQ0FBVVUsU0FBVixDQUFvQkcsTUFBcEIsQ0FBMkIsVUFBM0IsQ0FDSCxDQTNFUSxTQStFUCxFQUFVLE1BQVksVUFBWixDQS9FSCxDQWlGVCxFQUFTLEVBakZBLENBa0ZULEVBQVEsRUFsRkMsQ0FtRlQsRUFBUSxFQW5GQyxDQW9GVCxFQUFPLEVBcEZFLENBcUZULElBckZTLENBdUZQLEVBQVMsQ0FDWEMsT0FBUSxrQkFBTyxhQUVQQyxVQUFvQixDQUFOLEVBRlAsS0FHUCxFQUFPM0MsTUFBUCxFQUFpQixFQUFLQyxLQUhmLE9BSVgsR0FBVSxHQUFWLENBQ0gsQ0FOVSxDQU9YMkMsUUFBUyxrQkFBTSxDQUNYLElBQUksRUFBTzVDLE1BQVAsR0FBa0IsRUFBS0MsS0FBdkIsR0FBSixJQUNJLEVBQUtvQixJQUFMLENBQVksR0FBVSxJQUQxQixDQUVJLEVBQU13QixJQUFOLEdBRkosQ0FHUSxDQUFDLEVBQVEsRUFBS3JDLEtBQUwsQ0FBYSxDQUFyQixDQUhULEVBR2tDLENBQzFCLEdBQU0sSUFBTixDQUdBLE1BRkEsR0FBUSxDQUFSLENBRUEsQ0FEQSxHQUNBLEVBQ0gsQ0FFUixDQWxCVSxDQW1CWHNDLE1BQU8sZ0JBQU0sQ0FDVCxJQURTLElBRUksRUFBUUMsUUFBUixFQUNoQixDQXRCVSxDQXVCWEMsTUFBTyxpQkFBTyxDQUNWLEdBRFUsQ0FFVixFQUFRLENBQVIsQ0FDSCxDQTFCVSxDQTJCWHpDLE9BM0JXLENBNEJYMEMsT0E1QlcsQ0E2QlhDLFNBN0JXLENBdkZGLENBcUpQLEVBQVlDLE9BQU9DLFFBQVAsQ0FBZ0JDLElBQWhCLEVBckpMLENBd0pQLEVBQVlGLE9BQU9DLFFBQVAsQ0FBZ0JFLFNBQWhCLEVBeEpMLENBcUtQLEVBQWtCLEVBcktYLENBc0tiLEVBQWEsU0FBYixHQUFtQyxhQUF1QixDQUN0RCxFQUFnQlQsSUFBaEIsR0FEc0QsQ0FFdEQsRUFBU1UsS0FBVCxDQUFpQixFQUZxQyxDQUd0RCxFQUFhLE9BQWIsR0FBK0IsYUFBdUIsQ0FDbEQsRUFBU3ZDLEdBQVQsRUFEa0QsQ0FFbEQsRUFBU3VDLEtBQVQsQ0FBZVYsSUFBZixHQUZrRCxDQUdsRCxFQUFTM0MsT0FBVCxDQUFtQixFQUgrQixDQUtsRCxFQUFhLFNBQWIsR0FBaUMsV0FBYSxDQUUxQyxFQUFTQSxPQUFULENBQWlCMkMsSUFBakIsR0FGMEMsQ0FHekMsR0FBSVcsTUFBSixFQUFELENBQWN4QixHQUFkLENBQW9CLEVBQVVMLEdBQ2pDLENBSkQsQ0FMa0QsQ0FVbEQsRUFBT3FCLEtBQVAsQ0FBYSxFQUFnQixDQUFoQixFQUFtQk8sS0FBaEMsQ0FDSCxDQVhELENBWUgsQ0FmRCxDQXRLYSxDQWdNYixHQUFNLEdBQWMsQ0FDaEJFLFFBQVMsa0JBQVksQ0FDakIsRUFBT2YsTUFBUCxDQUFjLEtBQUtQLFdBQUwsQ0FBaUJDLElBQWpCLEVBQWQsQ0FDSCxDQUhlLENBSWhCc0IsT0FBUSxpQkFBWSxDQUNoQixFQUFPWixLQUFQLEVBQ0gsQ0FOZSxDQU9oQmEsU0FBVSxtQkFBWSxDQUNsQixFQUFPcEQsS0FBUCxFQUNILENBVGUsQ0FVaEJxRCxVQUFXLG9CQUFZLENBQ25CLEdBQU0sR0FBUSxFQUFPaEIsT0FBUCxFQUFkLENBQ0EsR0FBUyxJQUNaLENBYmUsQ0FBcEIsQ0FnQkFpQixNQUFNQyxTQUFOLENBQWdCaEQsT0FBaEIsQ0FBd0JpRCxJQUF4QixDQUNJbEMsU0FBU21DLGdCQUFULENBQTBCLGVBQTFCLENBREosQ0FFSSxrQkFBTyxHQUFJQyxnQkFBSixDQUFxQixPQUFyQixDQUE4QixVQUFZLENBQzdDLEVBQVksS0FBS0MsT0FBTCxDQUFhQyxLQUF6QixFQUFnQ0osSUFBaEMsQ0FBcUMsSUFBckMsQ0FDSCxDQUZNLENBQVAsQ0FGSixDQW1DQyxDQW5QQSxHIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuJ3VzZSBzdHJpY3QnO1xuXG5jbGFzcyBDYW5keSB7XHJcbiAgICBjb25zdHJ1Y3RvcihudW1iZXIsIG5hbWUsIHBhcnR5LCBpbWcpIHtcclxuICAgICAgICB0aGlzLmltZyA9IGltZztcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMucGFydHkgPSBwYXJ0eTtcclxuICAgICAgICB0aGlzLm51bWJlciA9IG51bWJlcjtcclxuICAgIH1cclxuICAgIHBsYWluT2JqZWN0KCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGltZzogdGhpcy5pbWcsXHJcbiAgICAgICAgICAgIG5hbWU6IHRoaXMubmFtZSxcclxuICAgICAgICAgICAgcGFydHk6IHRoaXMucGFydHksXHJcbiAgICAgICAgICAgIG51bWJlcjogdGhpcy5udW1iZXJcclxuICAgICAgICB9XHJcbiAgICB9IFxyXG4gICAgc3RhdGljIG51bGxDYW5keSgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IENhbmR5KCcnLCAnTsOaTUVSTyBFUlJBRE8nLCAnVk9UTyBOVUxPJyk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgYmxhbmtDYW5keSgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IENhbmR5KCcnLCAnJywgJ1ZPVE8gRU0gQlJBTkNPJyk7XHJcbiAgICB9XHJcbn1cblxuY2xhc3MgRGlzcGxheSB7XHJcblxyXG4gICAgY29uc3RydWN0b3Iod2hhdCkge1xyXG4gICAgICAgIGNvbnN0IHJvb3QgPSB0aGlzLnJvb3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHdoYXQpO1xyXG4gICAgICAgIGlmICghcm9vdCkgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMucG9zaXRpb24gPSByb290LnF1ZXJ5U2VsZWN0b3IoJy5kaXNwbGF5LXBvc2l0aW9uJyk7XHJcbiAgICAgICAgdGhpcy5udW1iZXIgPSByb290LnF1ZXJ5U2VsZWN0b3IoJy5kaXNwbGF5LW51bWJlcicpO1xyXG4gICAgICAgIHRoaXMuaW1nID0gcm9vdC5xdWVyeVNlbGVjdG9yKCcuZGlzcGxheS1pbWcnKTtcclxuICAgICAgICB0aGlzLmJsYW5rX2ltZyA9IHRoaXMuaW1nLnNyYztcclxuICAgICAgICB0aGlzLm5hbWUgPSByb290LnF1ZXJ5U2VsZWN0b3IoJy5kaXNwbGF5LW5hbWUnKTtcclxuICAgICAgICB0aGlzLnBhcnR5ID0gcm9vdC5xdWVyeVNlbGVjdG9yKCcuZGlzcGxheS1wYXJ0eScpO1xyXG4gICAgICAgIHRoaXMuYm9keSA9IHJvb3QucXVlcnlTZWxlY3RvcignLmRpc3BsYXktYm9keScpO1xyXG4gICAgICAgIHRoaXMuZm9vdGVyID0gcm9vdC5xdWVyeVNlbGVjdG9yKCcuZGlzcGxheS1mb290ZXInKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXROdW1iZXIobikge1xyXG4gICAgICAgIHRoaXMubnVtYmVyLnRleHRDb250ZW50ID0gbi50cmltKCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0UG9zaXRpb24ocCkge1xyXG4gICAgICAgIHRoaXMucG9zaXRpb24udGV4dENvbnRlbnQgPSBwLnRyaW0oKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXQoY2FuZHkpIHtcclxuICAgICAgICB0aGlzLmltZy5zcmMgPSBjYW5keS5pbWcgfHwgdGhpcy5ibGFua19pbWc7XHJcbiAgICAgICAgdGhpcy5uYW1lLnRleHRDb250ZW50ID0gY2FuZHkubmFtZTtcclxuICAgICAgICB0aGlzLnBhcnR5LnRleHRDb250ZW50ID0gY2FuZHkucGFydHk7XHJcbiAgICAgICAgdGhpcy5ib2R5LnJlbW92ZUF0dHJpYnV0ZSgnaGlkZGVuJyk7XHJcbiAgICAgICAgdGhpcy5mb290ZXIucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXROdWxsKCkge1xyXG4gICAgICAgIHRoaXMuc2V0KENhbmR5Lm51bGxDYW5keSgpKTtcclxuICAgICAgICB0aGlzLnJvb3QuY2xhc3NMaXN0LmFkZCgnaXMtbnVsbCcpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEJsYW5rKCkge1xyXG4gICAgICAgIHRoaXMuc2V0KENhbmR5LmJsYW5rQ2FuZHkoKSk7XHJcbiAgICAgICAgdGhpcy5yb290LmNsYXNzTGlzdC5hZGQoJ2lzLWJsYW5rJyk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXIoKSB7XHJcbiAgICAgICAgdGhpcy5pbWcuc3JjID0gdGhpcy5ibGFua19pbWc7XHJcbiAgICAgICAgdGhpcy5uYW1lLnRleHRDb250ZW50ID0gJyc7XHJcbiAgICAgICAgdGhpcy5wYXJ0eS50ZXh0Q29udGVudCA9ICcnO1xyXG4gICAgICAgIHRoaXMuYm9keS5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsIHRydWUpO1xyXG4gICAgICAgIHRoaXMuZm9vdGVyLnNldEF0dHJpYnV0ZSgnaGlkZGVuJywgdHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5yb290LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLW51bGwnKTtcclxuICAgICAgICB0aGlzLnJvb3QuY2xhc3NMaXN0LnJlbW92ZSgnaXMtYmxhbmsnKTtcclxuICAgIH1cclxuXHJcbn1cblxuY29uc3QgZGlzcGxheSA9IG5ldyBEaXNwbGF5KCcuZGlzcGxheScpO1xyXG5cclxubGV0IG51bWJlciA9ICcnO1xyXG5sZXQgdm90ZXMgPSBbXTtcclxubGV0IHN0ZXBzID0gW107XHJcbmxldCBzdGVwID0ge307XHJcbmxldCBpc0JsYW5rID0gZmFsc2U7XHJcblxyXG5jb25zdCBiYWxsb3QgPSB7XHJcbiAgICBpbnNlcnQ6IG51bSA9PiB7XHJcbiAgICAgICAgaWYgKGlzQmxhbmspIHJldHVybiBmYWxzZTtcclxuICAgICAgICBpZiAoaXNOYU4obnVtKSB8fCBudW0gPCAwKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgaWYgKG51bWJlci5sZW5ndGggPj0gc3RlcC5saW1pdCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIHNldE51bWJlcihudW1iZXIgKyBudW0pO1xyXG4gICAgfSxcclxuICAgIGNvbmZpcm06ICgpID0+IHtcclxuICAgICAgICBpZiAobnVtYmVyLmxlbmd0aCA9PT0gc3RlcC5saW1pdCB8fCBpc0JsYW5rKSB7XHJcbiAgICAgICAgICAgIHN0ZXAudm90ZSA9IG51bWJlciB8fCBudWxsO1xyXG4gICAgICAgICAgICB2b3Rlcy5wdXNoKHN0ZXApO1xyXG4gICAgICAgICAgICBpZiAoIXNldFN0ZXAoc3RlcC5pbmRleCArIDEpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHRzID0gdm90ZXM7XHJcbiAgICAgICAgICAgICAgICBzZXRTdGVwKDApO1xyXG4gICAgICAgICAgICAgICAgcmVzdGFydCgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgYmxhbms6ICgpID0+IHtcclxuICAgICAgICBpc0JsYW5rID0gdHJ1ZTtcclxuICAgICAgICBpZiAoIW51bWJlcikgZGlzcGxheS5zZXRCbGFuaygpO1xyXG4gICAgfSxcclxuICAgIHN0YXJ0OiAocykgPT4ge1xyXG4gICAgICAgIHN0ZXBzID0gcztcclxuICAgICAgICBzZXRTdGVwKDApO1xyXG4gICAgfSxcclxuICAgIGNsZWFyLFxyXG4gICAgdm90ZXMsXHJcbiAgICBkaXNwbGF5XHJcbn07XHJcblxyXG5mdW5jdGlvbiBzZXROdW1iZXIobnVtKSB7XHJcbiAgICBudW1iZXIgPSBudW07XHJcbiAgICBkaXNwbGF5LnNldE51bWJlcihudW1iZXIpO1xyXG4gICAgaWYgKG51bWJlci5sZW5ndGggPT09IHN0ZXAubGltaXQpIHtcclxuICAgICAgICBjb25zdCBjYW5keSA9IHN0ZXAuY2FuZGllcy5maWx0ZXIoYyA9PiBjLm51bWJlciA9PT0gbnVtYmVyKVswXTtcclxuICAgICAgICBpZiAoY2FuZHkpIGRpc3BsYXkuc2V0KGNhbmR5KTtcclxuICAgICAgICBlbHNlIGRpc3BsYXkuc2V0TnVsbCgpO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjbGVhcigpIHtcclxuICAgIGlzQmxhbmsgPSBmYWxzZTtcclxuICAgIHNldE51bWJlcignJyk7XHJcbiAgICBkaXNwbGF5LmNsZWFyKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldFN0ZXAoaSkge1xyXG4gICAgc3RlcCA9IHN0ZXBzW2ldO1xyXG4gICAgaWYgKCFzdGVwKSByZXR1cm4gZmFsc2U7XHJcbiAgICBzdGVwLmluZGV4ID0gaTtcclxuICAgIGRpc3BsYXkuc2V0UG9zaXRpb24oc3RlcC5wb3NpdGlvbik7XHJcbiAgICBjbGVhcigpO1xyXG4gICAgcmV0dXJuIHN0ZXA7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlc3RhcnQoKSB7XHJcbiAgICB2b3RlcyA9IFtdO1xyXG4gICAgc2V0U3RlcCgwKTtcclxufVxuXG5jb25zdCBGSVJFX0FVVEggPSB3aW5kb3cuZmlyZWJhc2UuYXV0aCgpO1xyXG5cclxuLy8gaHR0cHM6Ly9maXJlYmFzZS5nb29nbGUuY29tL2RvY3MvZmlyZXN0b3JlL3F1aWNrc3RhcnQ/YXV0aHVzZXI9MFxyXG5jb25zdCBGSVJFU1RPUkUgPSB3aW5kb3cuZmlyZWJhc2UuZmlyZXN0b3JlKCk7XHJcblxyXG5mdW5jdGlvbiBnZXRDb2xsZXRpb24oY29sbE5hbWUsIHJlZiwgY2FsbGJhY2spIHtcclxuICAgIHJlZi5jb2xsZWN0aW9uKGNvbGxOYW1lKS5nZXQoKS50aGVuKHNuYXAgPT4ge1xyXG4gICAgICAgIHNuYXAuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGl0ZW0uZGF0YSgpO1xyXG4gICAgICAgICAgICBkYXRhLnJlZiA9IGl0ZW0ucmVmO1xyXG4gICAgICAgICAgICBkYXRhLmlkID0gaXRlbS5pZDtcclxuICAgICAgICAgICAgY2FsbGJhY2soZGF0YSwgaXRlbS5yZWYpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmNvbnN0IGJhbGxvdF9hbGxfZGF0YSA9IFtdO1xyXG5nZXRDb2xsZXRpb24oJ2JhbGxvdHMnLCBGSVJFU1RPUkUsIChiYWxsRGF0YSwgYmFsbFJlZikgPT4ge1xyXG4gICAgYmFsbG90X2FsbF9kYXRhLnB1c2goYmFsbERhdGEpO1xyXG4gICAgYmFsbERhdGEuc3RlcHMgPSBbXTtcclxuICAgIGdldENvbGxldGlvbignc3RlcHMnLCBiYWxsUmVmLCAoc3RlcERhdGEsIHN0ZXBSZWYpID0+IHtcclxuICAgICAgICBzdGVwRGF0YS5yZWYgPSBzdGVwUmVmO1xyXG4gICAgICAgIGJhbGxEYXRhLnN0ZXBzLnB1c2goc3RlcERhdGEpO1xyXG4gICAgICAgIHN0ZXBEYXRhLmNhbmRpZXMgPSBbXTtcclxuICAgICAgICAvLyBwYXVzYXIgbyBhcGxpY2F0aXZvIGFxdWlcclxuICAgICAgICBnZXRDb2xsZXRpb24oJ2NhbmRpZXMnLCBzdGVwUmVmLCBjYW5keURhdGEgPT4ge1xyXG4gICAgICAgICAgICAvLyBjb250aW51YXIgYSBleGVjdcOnw6NvIGFxdWlcclxuICAgICAgICAgICAgc3RlcERhdGEuY2FuZGllcy5wdXNoKGNhbmR5RGF0YSk7XHJcbiAgICAgICAgICAgIChuZXcgSW1hZ2UoKSkuc3JjID0gY2FuZHlEYXRhLmltZztcclxuICAgICAgICB9KTtcclxuICAgICAgICBiYWxsb3Quc3RhcnQoYmFsbG90X2FsbF9kYXRhWzBdLnN0ZXBzKTtcclxuICAgIH0pO1xyXG59KTtcclxuXHJcbi8vIGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL2ZpcmViYXNlXHJcblxyXG4vKipcclxuICogVE9ETzogQ2FycmVnYXIgbGlzdGEgZGUgZWxlacOnw7VlcyB7dMOtdHVsbywgZGVzY3Jpw6fDo28sIHBhc3Nvc1t7cG9zaXRpb24sIGxpbWl0LCBjYW5kaWVzW119XX1cclxuICogVE9ETzogQ2FycmVnYXIgbGlzdGEgZGUgc2FsYXMgW3tub21lLCB0dXJtYSwgcGVyw61vZG99XVxyXG4gKiBUT0RPOiBJbnN0YW5jaWFyIHR1cm5vcyBkYSBlbGVpw6fDo28gW2Fub11cclxuICogVE9ETzogTGlzdGFyIHJlc3VsdGFkb3NcclxuICovXHJcblxyXG5jb25zdCBwYW5lbEFjdGlvbiA9IHtcclxuICAgIGRpZ2l0YXI6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBiYWxsb3QuaW5zZXJ0KHRoaXMudGV4dENvbnRlbnQudHJpbSgpKTtcclxuICAgIH0sXHJcbiAgICBicmFuY286IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBiYWxsb3QuYmxhbmsoKTtcclxuICAgIH0sXHJcbiAgICBjb3JyaWdpcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGJhbGxvdC5jbGVhcigpO1xyXG4gICAgfSxcclxuICAgIGNvbmZpcm1hcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnN0IHZvdGVzID0gYmFsbG90LmNvbmZpcm0oKTtcclxuICAgICAgICB2b3RlcyAmJiBzZW5kQmFsbG90KHZvdGVzKTtcclxuICAgIH1cclxufTtcclxuXHJcbkFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoXHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGFuZWwgYnV0dG9uJyksXHJcbiAgICBidG4gPT4gYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHBhbmVsQWN0aW9uW3RoaXMuZGF0YXNldC5jbGlja10uY2FsbCh0aGlzKTtcclxuICAgIH0pXHJcbik7XHJcblxyXG5mdW5jdGlvbiBzZW5kQmFsbG90KHZvdGVzKSB7XHJcbiAgICBjb25zb2xlLmxvZygnRW52aWFuZG8gdm90b3MnKTtcclxuXHJcbiAgICBjb25zdCByZXN1bHRzID0gdm90ZXMubWFwKHYgPT4ge1xyXG4gICAgICAgIGNvbnN0IHtcclxuICAgICAgICAgICAgcG9zaXRpb24sXHJcbiAgICAgICAgICAgIGNhbmRpZXMsXHJcbiAgICAgICAgICAgIHZvdGVcclxuICAgICAgICB9ID0gdjtcclxuICAgICAgICBjb25zdCBjYW5keSA9ICF2b3RlID9cclxuICAgICAgICAgICAgQ2FuZHkuYmxhbmtDYW5keSgpIDpcclxuICAgICAgICAgICAgY2FuZGllcy5maWx0ZXIoYyA9PiBjLm51bWJlciA9PT0gdm90ZSlbMF0gfHxcclxuICAgICAgICAgICAgQ2FuZHkubnVsbENhbmR5KCk7XHJcbiAgICAgICAgY29uc3Qge1xyXG4gICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICBwYXJ0eVxyXG4gICAgICAgIH0gPSBjYW5keTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBwb3NpdGlvbixcclxuICAgICAgICAgICAgdm90ZSxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgcGFydHlcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc29sZS50YWJsZShyZXN1bHRzKTtcclxufVxuXG59KCkpO1xuIl19
